(function(l,w){typeof exports=="object"&&typeof module<"u"?w(exports):typeof define=="function"&&define.amd?define(["exports"],w):(l=typeof globalThis<"u"?globalThis:l||self,w(l.Stage={}))})(this,function(l){"use strict";var Bt=Object.defineProperty;var Ht=(l,w,A)=>w in l?Bt(l,w,{enumerable:!0,configurable:!0,writable:!0,value:A}):l[w]=A;var v=(l,w,A)=>(Ht(l,typeof w!="symbol"?w+"":w,A),A);const w={create:0,tick:0,node:0,draw:0,fps:0};class A{constructor(i,e,s,n,r,h){this.reset(i,e,s,n,r,h)}toString(){return"["+this.a+", "+this.b+", "+this.c+", "+this.d+", "+this.e+", "+this.f+"]"}clone(){return new A(this.a,this.b,this.c,this.d,this.e,this.f)}reset(i,e,s,n,r,h){return this._dirty=!0,typeof i=="object"?(this.a=i.a,this.d=i.d,this.b=i.b,this.c=i.c,this.e=i.e,this.f=i.f):(this.a=i||1,this.d=n||1,this.b=e||0,this.c=s||0,this.e=r||0,this.f=h||0),this}identity(){return this._dirty=!0,this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}rotate(i){if(!i)return this;this._dirty=!0;var e=i?Math.cos(i):1,s=i?Math.sin(i):0,n=e*this.a-s*this.b,r=e*this.b+s*this.a,h=e*this.c-s*this.d,_=e*this.d+s*this.c,o=e*this.e-s*this.f,p=e*this.f+s*this.e;return this.a=n,this.b=r,this.c=h,this.d=_,this.e=o,this.f=p,this}translate(i,e){return!i&&!e?this:(this._dirty=!0,this.e+=i,this.f+=e,this)}scale(i,e){return!(i-1)&&!(e-1)?this:(this._dirty=!0,this.a*=i,this.b*=e,this.c*=i,this.d*=e,this.e*=i,this.f*=e,this)}skew(i,e){if(!i&&!e)return this;this._dirty=!0;var s=this.a+this.b*i,n=this.b+this.a*e,r=this.c+this.d*i,h=this.d+this.c*e,_=this.e+this.f*i,o=this.f+this.e*e;return this.a=s,this.b=n,this.c=r,this.d=h,this.e=_,this.f=o,this}concat(i){this._dirty=!0;var e=this,s=e.a*i.a+e.b*i.c,n=e.b*i.d+e.a*i.b,r=e.c*i.a+e.d*i.c,h=e.d*i.d+e.c*i.b,_=e.e*i.a+i.e+e.f*i.c,o=e.f*i.d+i.f+e.e*i.b;return this.a=s,this.b=n,this.c=r,this.d=h,this.e=_,this.f=o,this}inverse(){if(this._dirty){this._dirty=!1,this.inverted=this.inverted||new A;var i=this.a*this.d-this.b*this.c;this.inverted.a=this.d/i,this.inverted.b=-this.b/i,this.inverted.c=-this.c/i,this.inverted.d=this.a/i,this.inverted.e=(this.c*this.f-this.e*this.d)/i,this.inverted.f=(this.e*this.b-this.a*this.f)/i}return this.inverted}map(i,e){return e=e||{},e.x=this.a*i.x+this.c*i.y+this.e,e.y=this.b*i.x+this.d*i.y+this.f,e}mapX(i,e){return typeof i=="object"&&(e=i.y,i=i.x),this.a*i+this.c*e+this.e}mapY(i,e){return typeof i=="object"&&(e=i.y,i=i.x),this.b*i+this.d*e+this.f}}var d=0;function Y(t){this._owner=t,this._parent=null,this._relativeMatrix=new A,this._absoluteMatrix=new A,this.reset()}Y.prototype.reset=function(){this._textureAlpha=1,this._alpha=1,this._width=0,this._height=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._rotation=0,this._pivoted=!1,this._pivotX=null,this._pivotY=null,this._handled=!1,this._handleX=0,this._handleY=0,this._aligned=!1,this._alignX=0,this._alignY=0,this._offsetX=0,this._offsetY=0,this._boxX=0,this._boxY=0,this._boxWidth=this._width,this._boxHeight=this._height,this._ts_translate=++d,this._ts_transform=++d,this._ts_matrix=++d},Y.prototype._update=function(){return this._parent=this._owner._parent&&this._owner._parent._pin,this._handled&&this._mo_handle!=this._ts_transform&&(this._mo_handle=this._ts_transform,this._ts_translate=++d),this._aligned&&this._parent&&this._mo_align!=this._parent._ts_transform&&(this._mo_align=this._parent._ts_transform,this._ts_translate=++d),this},Y.prototype.toString=function(){return this._owner+" ("+(this._parent?this._parent._owner:null)+")"},Y.prototype.absoluteMatrix=function(){this._update();var t=Math.max(this._ts_transform,this._ts_translate,this._parent?this._parent._ts_matrix:0);if(this._mo_abs==t)return this._absoluteMatrix;this._mo_abs=t;var i=this._absoluteMatrix;return i.reset(this.relativeMatrix()),this._parent&&i.concat(this._parent._absoluteMatrix),this._ts_matrix=++d,i},Y.prototype.relativeMatrix=function(){this._update();var t=Math.max(this._ts_transform,this._ts_translate,this._parent?this._parent._ts_transform:0);if(this._mo_rel==t)return this._relativeMatrix;this._mo_rel=t;var i=this._relativeMatrix;if(i.identity(),this._pivoted&&i.translate(-this._pivotX*this._width,-this._pivotY*this._height),i.scale(this._scaleX,this._scaleY),i.skew(this._skewX,this._skewY),i.rotate(this._rotation),this._pivoted&&i.translate(this._pivotX*this._width,this._pivotY*this._height),this._pivoted)this._boxX=0,this._boxY=0,this._boxWidth=this._width,this._boxHeight=this._height;else{var e,s;i.a>0&&i.c>0||i.a<0&&i.c<0?(e=0,s=i.a*this._width+i.c*this._height):(e=i.a*this._width,s=i.c*this._height),e>s?(this._boxX=s,this._boxWidth=e-s):(this._boxX=e,this._boxWidth=s-e),i.b>0&&i.d>0||i.b<0&&i.d<0?(e=0,s=i.b*this._width+i.d*this._height):(e=i.b*this._width,s=i.d*this._height),e>s?(this._boxY=s,this._boxHeight=e-s):(this._boxY=e,this._boxHeight=s-e)}return this._x=this._offsetX,this._y=this._offsetY,this._x-=this._boxX+this._handleX*this._boxWidth,this._y-=this._boxY+this._handleY*this._boxHeight,this._aligned&&this._parent&&(this._parent.relativeMatrix(),this._x+=this._alignX*this._parent._width,this._y+=this._alignY*this._parent._height),i.translate(this._x,this._y),this._relativeMatrix},Y.prototype.get=function(t){if(typeof ot[t]=="function")return ot[t](this)},Y.prototype.set=function(t,i){if(typeof t=="string")typeof G[t]=="function"&&typeof i<"u"&&G[t](this,i);else if(typeof t=="object")for(i in t)typeof G[i]=="function"&&typeof t[i]<"u"&&G[i](this,t[i],t);return this._owner&&(this._owner._ts_pin=++d,this._owner.touch()),this};var ot={alpha:function(t){return t._alpha},textureAlpha:function(t){return t._textureAlpha},width:function(t){return t._width},height:function(t){return t._height},boxWidth:function(t){return t._boxWidth},boxHeight:function(t){return t._boxHeight},scaleX:function(t){return t._scaleX},scaleY:function(t){return t._scaleY},skewX:function(t){return t._skewX},skewY:function(t){return t._skewY},rotation:function(t){return t._rotation},pivotX:function(t){return t._pivotX},pivotY:function(t){return t._pivotY},offsetX:function(t){return t._offsetX},offsetY:function(t){return t._offsetY},alignX:function(t){return t._alignX},alignY:function(t){return t._alignY},handleX:function(t){return t._handleX},handleY:function(t){return t._handleY}},G={alpha:function(t,i){t._alpha=i},textureAlpha:function(t,i){t._textureAlpha=i},width:function(t,i){t._width_=i,t._width=i,t._ts_transform=++d},height:function(t,i){t._height_=i,t._height=i,t._ts_transform=++d},scale:function(t,i){t._scaleX=i,t._scaleY=i,t._ts_transform=++d},scaleX:function(t,i){t._scaleX=i,t._ts_transform=++d},scaleY:function(t,i){t._scaleY=i,t._ts_transform=++d},skew:function(t,i){t._skewX=i,t._skewY=i,t._ts_transform=++d},skewX:function(t,i){t._skewX=i,t._ts_transform=++d},skewY:function(t,i){t._skewY=i,t._ts_transform=++d},rotation:function(t,i){t._rotation=i,t._ts_transform=++d},pivot:function(t,i){t._pivotX=i,t._pivotY=i,t._pivoted=!0,t._ts_transform=++d},pivotX:function(t,i){t._pivotX=i,t._pivoted=!0,t._ts_transform=++d},pivotY:function(t,i){t._pivotY=i,t._pivoted=!0,t._ts_transform=++d},offset:function(t,i){t._offsetX=i,t._offsetY=i,t._ts_translate=++d},offsetX:function(t,i){t._offsetX=i,t._ts_translate=++d},offsetY:function(t,i){t._offsetY=i,t._ts_translate=++d},align:function(t,i){this.alignX(t,i),this.alignY(t,i)},alignX:function(t,i){t._alignX=i,t._aligned=!0,t._ts_translate=++d,this.handleX(t,i)},alignY:function(t,i){t._alignY=i,t._aligned=!0,t._ts_translate=++d,this.handleY(t,i)},handle:function(t,i){this.handleX(t,i),this.handleY(t,i)},handleX:function(t,i){t._handleX=i,t._handled=!0,t._ts_translate=++d},handleY:function(t,i){t._handleY=i,t._handled=!0,t._ts_translate=++d},resizeMode:function(t,i,e){e&&(i=="in"?i="in-pad":i=="out"&&(i="out-crop"),C(t,e.resizeWidth,e.resizeHeight,i))},resizeWidth:function(t,i,e){(!e||!e.resizeMode)&&C(t,i,null)},resizeHeight:function(t,i,e){(!e||!e.resizeMode)&&C(t,null,i)},scaleMode:function(t,i,e){e&&C(t,e.scaleWidth,e.scaleHeight,i)},scaleWidth:function(t,i,e){(!e||!e.scaleMode)&&C(t,i,null)},scaleHeight:function(t,i,e){(!e||!e.scaleMode)&&C(t,null,i)},matrix:function(t,i){this.scaleX(t,i.a),this.skewX(t,i.c/i.d),this.skewY(t,i.b/i.a),this.scaleY(t,i.d),this.offsetX(t,i.e),this.offsetY(t,i.f),this.rotation(t,0)}};Y.prototype.scaleTo=function(t,i,e){C(this,t,i,e)};function C(t,i,e,s){var n=typeof i=="number",r=typeof e=="number",h=typeof s=="string";t._ts_transform=++d,n&&(t._scaleX=i/t._width_,t._width=t._width_),r&&(t._scaleY=e/t._height_,t._height=t._height_),n&&r&&h&&(s=="out"||s=="out-crop"?t._scaleX=t._scaleY=Math.max(t._scaleX,t._scaleY):(s=="in"||s=="in-pad")&&(t._scaleX=t._scaleY=Math.min(t._scaleX,t._scaleY)),(s=="out-crop"||s=="in-pad")&&(t._width=i/t._scaleX,t._height=e/t._scaleY))}Y._add_shortcuts=function(t){t.size=function(i,e){return this.pin("width",i),this.pin("height",e),this},t.width=function(i){return typeof i>"u"?this.pin("width"):(this.pin("width",i),this)},t.height=function(i){return typeof i>"u"?this.pin("height"):(this.pin("height",i),this)},t.offset=function(i,e){return typeof i=="object"&&(e=i.y,i=i.x),this.pin("offsetX",i),this.pin("offsetY",e),this},t.rotate=function(i){return this.pin("rotation",i),this},t.skew=function(i,e){return typeof i=="object"?(e=i.y,i=i.x):typeof e>"u"&&(e=i),this.pin("skewX",i),this.pin("skewY",e),this},t.scale=function(i,e){return typeof i=="object"?(e=i.y,i=i.x):typeof e>"u"&&(e=i),this.pin("scaleX",i),this.pin("scaleY",e),this},t.alpha=function(i,e){return this.pin("alpha",i),typeof e<"u"&&this.pin("textureAlpha",e),this}};var E=0;w.create=0;function L(t){if(t&&t instanceof a)return t;throw"Invalid node: "+t}const N=function(){return new a};function a(){w.create++,this._pin=new Y(this)}a.prototype.matrix=function(t){return t===!0?this._pin.relativeMatrix():this._pin.absoluteMatrix()},a.prototype.pin=function(t,i){if(typeof t=="object")return this._pin.set(t),this;if(typeof t=="string")return typeof i>"u"?this._pin.get(t):(this._pin.set(t,i),this);if(typeof t>"u")return this._pin},a.prototype.scaleTo=function(t,i,e){return typeof t=="object"&&(e=i,i=t.y,t=t.x),this._pin.scaleTo(t,i,e),this},Y._add_shortcuts(a.prototype),a.prototype._label="",a.prototype._visible=!0,a.prototype._parent=null,a.prototype._next=null,a.prototype._prev=null,a.prototype._first=null,a.prototype._last=null,a.prototype._attrs=null,a.prototype._flags=null,a.prototype.toString=function(){return"["+this._label+"]"},a.prototype.id=function(t){return this.label(t)},a.prototype.label=function(t){return typeof t>"u"?this._label:(this._label=t,this)},a.prototype.attr=function(t,i){return typeof i>"u"?this._attrs!==null?this._attrs[t]:void 0:((this._attrs!==null?this._attrs:this._attrs={})[t]=i,this)},a.prototype.visible=function(t){return typeof t>"u"?this._visible:(this._visible=t,this._parent&&(this._parent._ts_children=++E),this._ts_pin=++E,this.touch(),this)},a.prototype.hide=function(){return this.visible(!1)},a.prototype.show=function(){return this.visible(!0)},a.prototype.parent=function(){return this._parent},a.prototype.next=function(t){for(var i=this._next;i&&t&&!i._visible;)i=i._next;return i},a.prototype.prev=function(t){for(var i=this._prev;i&&t&&!i._visible;)i=i._prev;return i},a.prototype.first=function(t){for(var i=this._first;i&&t&&!i._visible;)i=i._next;return i},a.prototype.last=function(t){for(var i=this._last;i&&t&&!i._visible;)i=i._prev;return i},a.prototype.visit=function(t,i){var e=t.reverse,s=t.visible;if(!(t.start&&t.start(this,i))){for(var n,r=e?this.last(s):this.first(s);n=r;)if(r=e?n.prev(s):n.next(s),n.visit(t,i))return!0;return t.end&&t.end(this,i)}},a.prototype.append=function(t,i){if(Array.isArray(t))for(var e=0;e<t.length;e++)K(this,t[e]);else if(typeof i<"u")for(var e=0;e<arguments.length;e++)K(this,arguments[e]);else typeof t<"u"&&K(this,t);return this},a.prototype.prepend=function(t,i){if(Array.isArray(t))for(var e=t.length-1;e>=0;e--)J(this,t[e]);else if(typeof i<"u")for(var e=arguments.length-1;e>=0;e--)J(this,arguments[e]);else typeof t<"u"&&J(this,t);return this},a.prototype.appendTo=function(t){return K(t,this),this},a.prototype.prependTo=function(t){return J(t,this),this},a.prototype.insertNext=function(t,i){if(Array.isArray(t))for(var e=0;e<t.length;e++)Z(t[e],this);else if(typeof i<"u")for(var e=0;e<arguments.length;e++)Z(arguments[e],this);else typeof t<"u"&&Z(t,this);return this},a.prototype.insertPrev=function(t,i){if(Array.isArray(t))for(var e=t.length-1;e>=0;e--)Q(t[e],this);else if(typeof i<"u")for(var e=arguments.length-1;e>=0;e--)Q(arguments[e],this);else typeof t<"u"&&Q(t,this);return this},a.prototype.insertAfter=function(t){return Z(this,t),this},a.prototype.insertBefore=function(t){return Q(this,t),this};function K(t,i){L(i),L(t),i.remove(),t._last&&(t._last._next=i,i._prev=t._last),i._parent=t,t._last=i,t._first||(t._first=i),i._parent._flag(i,!0),i._ts_parent=++E,t._ts_children=++E,t.touch()}function J(t,i){L(i),L(t),i.remove(),t._first&&(t._first._prev=i,i._next=t._first),i._parent=t,t._first=i,t._last||(t._last=i),i._parent._flag(i,!0),i._ts_parent=++E,t._ts_children=++E,t.touch()}function Q(t,i){L(t),L(i),t.remove();var e=i._parent,s=i._prev;i._prev=t,s&&(s._next=t)||e&&(e._first=t),t._parent=e,t._prev=s,t._next=i,t._parent._flag(t,!0),t._ts_parent=++E,t.touch()}function Z(t,i){L(t),L(i),t.remove();var e=i._parent,s=i._next;i._next=t,s&&(s._prev=t)||e&&(e._last=t),t._parent=e,t._prev=i,t._next=s,t._parent._flag(t,!0),t._ts_parent=++E,t.touch()}a.prototype.remove=function(t,i){if(typeof t<"u"){if(Array.isArray(t))for(var e=0;e<t.length;e++)L(t[e]).remove();else if(typeof i<"u")for(var e=0;e<arguments.length;e++)L(arguments[e]).remove();else L(t).remove();return this}return this._prev&&(this._prev._next=this._next),this._next&&(this._next._prev=this._prev),this._parent&&(this._parent._first===this&&(this._parent._first=this._next),this._parent._last===this&&(this._parent._last=this._prev),this._parent._flag(this,!1),this._parent._ts_children=++E,this._parent.touch()),this._prev=this._next=this._parent=null,this._ts_parent=++E,this},a.prototype.empty=function(){for(var t,i=this._first;t=i;)i=t._next,t._prev=t._next=t._parent=null,this._flag(t,!1);return this._first=this._last=null,this._ts_children=++E,this.touch(),this},a.prototype.touch=function(){return this._ts_touch=++E,this._parent&&this._parent.touch(),this},a.prototype._flag=function(t,i){if(typeof i>"u")return this._flags!==null&&this._flags[t]||0;if(typeof t=="string"&&(i?(this._flags=this._flags||{},!this._flags[t]&&this._parent&&this._parent._flag(t,!0),this._flags[t]=(this._flags[t]||0)+1):this._flags&&this._flags[t]>0&&(this._flags[t]==1&&this._parent&&this._parent._flag(t,!1),this._flags[t]=this._flags[t]-1)),typeof t=="object"&&t._flags)for(var e in t._flags)t._flags[e]>0&&this._flag(e,i);return this},a.prototype.hitTest=function(t){var i=this._pin._width,e=this._pin._height;return t.x>=0&&t.x<=i&&t.y>=0&&t.y<=e},a.prototype._textures=null,a.prototype._alpha=1,a.prototype.render=function(t){if(this._visible){w.node++;var i=this.matrix();t.setTransform(i.a,i.b,i.c,i.d,i.e,i.f),this._alpha=this._pin._alpha*(this._parent?this._parent._alpha:1);var e=this._pin._textureAlpha*this._alpha;if(t.globalAlpha!=e&&(t.globalAlpha=e),this._textures!==null)for(var s=0,n=this._textures.length;s<n;s++)this._textures[s].draw(t);t.globalAlpha!=this._alpha&&(t.globalAlpha=this._alpha);for(var r,h=this._first;r=h;)h=r._next,r.render(t)}},a.prototype._tickBefore=null,a.prototype._tickAfter=null,a.prototype.MAX_ELAPSE=1/0,a.prototype._tick=function(t,i,e){if(this._visible){t>this.MAX_ELAPSE&&(t=this.MAX_ELAPSE);var s=!1;if(this._tickBefore!==null)for(var n=0;n<this._tickBefore.length;n++){w.tick++;var r=this._tickBefore[n];s=r.call(this,t,i,e)===!0||s}for(var h,_=this._first;h=_;)_=h._next,h._flag("_tick")&&(s=h._tick(t,i,e)===!0?!0:s);if(this._tickAfter!==null)for(var n=0;n<this._tickAfter.length;n++){w.tick++;var r=this._tickAfter[n];s=r.call(this,t,i,e)===!0||s}return s}},a.prototype.tick=function(t,i){typeof t=="function"&&(i?(this._tickBefore===null&&(this._tickBefore=[]),this._tickBefore.push(t)):(this._tickAfter===null&&(this._tickAfter=[]),this._tickAfter.push(t)),this._flag("_tick",this._tickAfter!==null&&this._tickAfter.length>0||this._tickBefore!==null&&this._tickBefore.length>0))},a.prototype.untick=function(t){if(typeof t=="function"){var i;this._tickBefore!==null&&(i=this._tickBefore.indexOf(t))>=0&&this._tickBefore.splice(i,1),this._tickAfter!==null&&(i=this._tickAfter.indexOf(t))>=0&&this._tickAfter.splice(i,1)}},a.prototype.timeout=function(t,i){this.setTimeout(t,i)},a.prototype.setTimeout=function(t,i){function e(s){if((i-=s)<0)this.untick(e),t.call(this);else return!0}return this.tick(e),e},a.prototype.clearTimeout=function(t){this.untick(t)},a.prototype._listeners=null,a.prototype._event_callback=function(t,i){this._flag(t,i)},a.prototype.on=function(t,i){if(!t||!t.length||typeof i!="function")return this;this._listeners===null&&(this._listeners={});var e=typeof t!="string"&&typeof t.join=="function";if(t=(e?t.join(" "):t).match(/\S+/g))for(var s=0;s<t.length;s++){var n=t[s];this._listeners[n]=this._listeners[n]||[],this._listeners[n].push(i),typeof this._event_callback=="function"&&this._event_callback(n,!0)}return this},a.prototype.off=function(t,i){if(!t||!t.length||typeof i!="function")return this;if(this._listeners===null)return this;var e=typeof t!="string"&&typeof t.join=="function";if(t=(e?t.join(" "):t).match(/\S+/g))for(var s=0;s<t.length;s++){var n=t[s],r=this._listeners[n],h;r&&(h=r.indexOf(i))>=0&&(r.splice(h,1),r.length||delete this._listeners[n],typeof this._event_callback=="function"&&this._event_callback(n,!1))}return this},a.prototype.listeners=function(t){return this._listeners&&this._listeners[t]},a.prototype.publish=function(t,i){var e=this.listeners(t);if(!e||!e.length)return 0;for(var s=0;s<e.length;s++)e[s].apply(this,i);return e.length},a.prototype.trigger=function(t,i){return this.publish(t,i),this};var at=Math;const R=Object.create(Math);R.random=function(t,i){return typeof t>"u"?(i=1,t=0):typeof i>"u"&&(i=t,t=0),t==i?t:at.random()*(i-t)+t},R.modulo=function(t,i,e){return typeof i>"u"?(e=1,i=0):typeof e>"u"&&(e=i,i=0),e>i?(t=(t-i)%(e-i),t+(t<0?e:i)):(t=(t-e)%(i-e),t+(t<=0?i:e))},R.clamp=function(t,i,e){return t<i?i:t>e?e:t},R.length=function(t,i){return at.sqrt(t*t+i*i)};const W=function(t){var i=Object.prototype.toString.call(t);return i==="[object Function]"||i==="[object GeneratorFunction]"||i==="[object AsyncFunction]"},tt=function(t){return Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object};class j{constructor(i,e){typeof i=="object"&&this.src(i,e)}pipe(){return new j(this)}src(i,e,s,n){if(typeof i=="object"){var r=i,h=e||1;this._image=r,this._sx=this._dx=0,this._sy=this._dy=0,this._sw=this._dw=r.width/h,this._sh=this._dh=r.height/h,this.width=r.width/h,this.height=r.height/h,this.ratio=h}else typeof s>"u"?(s=i,n=e):(this._sx=i,this._sy=e),this._sw=this._dw=s,this._sh=this._dh=n,this.width=s,this.height=n;return this}dest(i,e,s,n){return this._dx=i,this._dy=e,this._dx=i,this._dy=e,typeof s<"u"&&(this._dw=s,this._dh=n,this.width=s,this.height=n),this}draw(i,e,s,n,r,h,_,o,p){var u=this._image;if(!(u===null||typeof u!="object")){var f=this._sx,c=this._sy,g=this._sw,m=this._sh,y=this._dx,M=this._dy,T=this._dw,x=this._dh;typeof h<"u"?(e=R.clamp(e,0,this._sw),n=R.clamp(n,0,this._sw-e),s=R.clamp(s,0,this._sh),r=R.clamp(r,0,this._sh-s),f+=e,c+=s,g=n,m=r,y=h,M=_,T=o,x=p):typeof n<"u"?(y=e,M=s,T=n,x=r):typeof e<"u"&&(T=e,x=s);var $=this.ratio||1;f*=$,c*=$,g*=$,m*=$;try{typeof u.draw=="function"?u.draw(i,f,c,g,m,y,M,T,x):(w.draw++,i.drawImage(u,f,c,g,m,y,M,T,x))}catch(X){u._draw_failed||(console.log("Unable to draw: ",u),console.log(X),u._draw_failed=!0)}}}}var ft=new class extends j{constructor(){super();v(this,"pipe",function(){return this});v(this,"src",function(){return this});v(this,"dest",function(){return this});v(this,"draw",function(){});this.x=this.y=this.width=this.height=0}},Et=new q(ft);function St(t){return console.log("Loading image: "+t),new Promise(function(i,e){const s=new Image;s.onload=function(){i(s)},s.onerror=function(n){e(n)},s.src=t})}var it={},et=[];const ut=async function(t){var i=W(t.draw)?t:new st(t);t.name&&(it[t.name]=i),et.push(i),z(t,"imagePath"),z(t,"imageRatio");var e=t.imagePath,s=t.imageRatio||1;if(typeof t.image=="string"?e=t.image:("src"in t.image||"url"in t.image)&&(e=t.image.src||t.image.url,s=t.image.ratio||s),e){const n=await St(e);i.src(n,s)}return i};class st extends j{constructor(i){super();var e=this;z(i,"filter"),z(i,"cutouts"),z(i,"sprites"),z(i,"factory");var s=i.map||i.filter,n=i.ppu||i.ratio||1,r=i.trim||0,h=i.textures,_=i.factory,o=i.cutouts||i.sprites;function p(f){if(!f||W(f.draw))return f;f=Object.assign({},f),W(s)&&(f=s(f)),n!=1&&(f.x*=n,f.y*=n,f.width*=n,f.height*=n,f.top*=n,f.bottom*=n,f.left*=n,f.right*=n),r!=0&&(f.x+=r,f.y+=r,f.width-=2*r,f.height-=2*r,f.top-=r,f.bottom-=r,f.left-=r,f.right-=r);var c=e.pipe();return c.top=f.top,c.bottom=f.bottom,c.left=f.left,c.right=f.right,c.src(f.x,f.y,f.width,f.height),c}function u(f){if(h){if(W(h))return h(f);if(tt(h))return h[f]}if(o){for(var c=null,g=0,m=0;m<o.length;m++)string.startsWith(o[m].name,f)&&(g===0?c=o[m]:g===1?c=[c,o[m]]:c.push(o[m]),g++);return g===0&&W(_)&&(c=function(y){return _(f+(y||""))}),c}}this.select=function(f){if(!f)return new q(this.pipe());var c=u(f);if(c)return new q(c,u,p)}}}function q(t,i,e){function s(n,r){if(n){if(W(n.draw))return n;if(tt(n)&&typeof n.width=="number"&&typeof n.height=="number"&&W(e))return e(n);if(tt(n)&&typeof r<"u")return s(n[r]);if(W(n))return s(n(r));if(Array.isArray(n))return s(n[0]);if(typeof n=="string"&&W(i))return s(i(n))}else return ft}this.one=function(n){return s(t,n)},this.array=function(n){var r=Array.isArray(n)?n:[];if(Array.isArray(t))for(var h=0;h<t.length;h++)r[h]=s(t[h]);else r[0]=s(t);return r}}const V=function(t){if(typeof t!="string")return new q(t);var i=null,e,s;for((s=t.indexOf(":"))>0&&t.length>s+1&&(e=it[t.slice(0,s)],i=e&&e.select(t.slice(s+1))),!i&&(e=it[t])&&(i=e.select()),s=0;!i&&s<et.length;s++)i=et[s].select(t);return i||(console.error("Texture not found: "+t),i=Et),i};function z(t,i,e){i in t&&console.log(e?e.replace("%name",i):"'"+i+"' field of texture atlas is deprecated.")}const _t=function(t,i,e){typeof t=="string"?typeof i=="object"||(typeof i=="function"&&(e=i),i={}):(typeof t=="function"&&(e=t),i={},t="2d");var s=document.createElement("canvas"),n=s.getContext(t,i),r=new j(s);return r.context=function(){return n},r.size=function(h,_,o){return o=o||1,s.width=h*o,s.height=_*o,this.src(s,o),this},typeof e=="function"&&e.call(r,n),r};class F{constructor(){v(this,"x",0);v(this,"y",0);v(this,"ratio",1);v(this,"stage");v(this,"elem");v(this,"clicklist",[]);v(this,"cancellist",[]);v(this,"handleStart",i=>{i.preventDefault(),this.locate(i),this.publish(i.type,i),this.lookup("click",this.clicklist),this.lookup("mousecancel",this.cancellist)});v(this,"handleMove",i=>{i.preventDefault(),this.locate(i),this.publish(i.type,i)});v(this,"handleEnd",i=>{i.preventDefault(),this.publish(i.type,i),this.clicklist.length&&this.publish("click",i,this.clicklist),this.cancellist.length=0});v(this,"handleCancel",i=>{this.cancellist.length&&this.publish("mousecancel",i,this.cancellist),this.clicklist.length=0});v(this,"toString",function(){return(this.x|0)+"x"+(this.y|0)});v(this,"locate",function(i){const e=this.elem;let s,n;i.touches&&i.touches.length?(s=i.touches[0].clientX,n=i.touches[0].clientY):(s=i.clientX,n=i.clientY);var r=e.getBoundingClientRect();s-=r.left,n-=r.top,s-=e.clientLeft|0,n-=e.clientTop|0,this.x=s*this.ratio,this.y=n*this.ratio});v(this,"lookup",function(i,e){this.type=i,this.root=this.stage,this.event=null,e.length=0,this.collect=e,this.root.visit({reverse:!0,visible:!0,start:this.visitStart,end:this.visitEnd},this)});v(this,"publish",function(i,e,s){if(this.type=i,this.root=this.stage,this.event=e,this.collect=!1,this.timeStamp=Date.now(),i!=="mousemove"&&i!=="touchmove"&&console.log(this.type+" "+this),s){for(;s.length&&!this.visitEnd(s.shift()););s.length=0}else this.root.visit({reverse:!0,visible:!0,start:this.visitStart,end:this.visitEnd},this)});v(this,"visitStart",i=>!i._flag(this.type));v(this,"visitEnd",i=>{O.raw=this.event,O.type=this.type,O.timeStamp=this.timeStamp,O.abs.x=this.x,O.abs.y=this.y;var e=i.listeners(this.type);if(e&&(i.matrix().inverse().map(this,O),!!(i===this.root||i.attr("spy")||i.hitTest(O))&&(this.collect&&this.collect.push(i),this.event))){for(var s=!1,n=0;n<e.length;n++)s=e[n].call(i,O)?!0:s;return s}})}mount(i,e){return this.stage=i,this.elem=e,this.ratio=i.viewport().ratio||1,i.on("viewport",s=>{this.ratio=s.ratio??this.ratio}),e.addEventListener("touchstart",this.handleStart),e.addEventListener("touchend",this.handleEnd),e.addEventListener("touchmove",this.handleMove),e.addEventListener("touchcancel",this.handleCancel),e.addEventListener("mousedown",this.handleStart),e.addEventListener("mouseup",this.handleEnd),e.addEventListener("mousemove",this.handleMove),document.addEventListener("mouseup",this.handleCancel),window.addEventListener("blur",this.handleCancel),this}unmount(){const i=this.elem;return i.removeEventListener("touchstart",this.handleStart),i.removeEventListener("touchend",this.handleEnd),i.removeEventListener("touchmove",this.handleMove),i.removeEventListener("touchcancel",this.handleCancel),i.removeEventListener("mousedown",this.handleStart),i.removeEventListener("mouseup",this.handleEnd),i.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleCancel),window.removeEventListener("blur",this.handleCancel),this}}v(F,"CLICK","click"),v(F,"START","touchstart mousedown"),v(F,"MOVE","touchmove mousemove"),v(F,"END","touchend mouseup"),v(F,"CANCEL","touchcancel mousecancel");var O={},nt={};U(O,"clone",function(t){return t=t||{},t.x=this.x,t.y=this.y,t}),U(O,"toString",function(){return(this.x|0)+"x"+(this.y|0)+" ("+this.abs+")"}),U(O,"abs",nt),U(nt,"clone",function(t){return t=t||{},t.x=this.x,t.y=this.y,t}),U(nt,"toString",function(){return(this.x|0)+"x"+(this.y|0)});function U(t,i,e){Object.defineProperty(t,i,{value:e})}function Tt(t){return t}var ct={},lt={},pt={};class b{static get(i,e=Tt){if(typeof i=="function")return i;if(typeof i!="string")return e;var s=ct[i];if(s)return s;var n=/^(\w+)(-(in|out|in-out|out-in))?(\((.*)\))?$/i.exec(i);if(!n||!n.length)return e;var r=pt[n[1]],h=lt[n[3]],_=n[5];return r&&r.fn?s=r.fn:r&&r.fc?s=r.fc.apply(r.fc,_&&_.replace(/\s+/,"").split(",")):s=e,h&&(s=h.fn(s)),ct[i]=s,s}static add(i){for(var e=(i.name||i.mode).split(/\s+/),s=0;s<e.length;s++){var n=e[s];n&&((i.name?pt:lt)[n]=i)}}}b.add({mode:"in",fn:function(t){return t}}),b.add({mode:"out",fn:function(t){return function(i){return 1-t(1-i)}}}),b.add({mode:"in-out",fn:function(t){return function(i){return i<.5?t(2*i)/2:1-t(2*(1-i))/2}}}),b.add({mode:"out-in",fn:function(t){return function(i){return i<.5?1-t(2*(1-i))/2:t(2*i)/2}}}),b.add({name:"linear",fn:function(t){return t}}),b.add({name:"quad",fn:function(t){return t*t}}),b.add({name:"cubic",fn:function(t){return t*t*t}}),b.add({name:"quart",fn:function(t){return t*t*t*t}}),b.add({name:"quint",fn:function(t){return t*t*t*t*t}}),b.add({name:"sin sine",fn:function(t){return 1-Math.cos(t*Math.PI/2)}}),b.add({name:"exp expo",fn:function(t){return t==0?0:Math.pow(2,10*(t-1))}}),b.add({name:"circle circ",fn:function(t){return 1-Math.sqrt(1-t*t)}}),b.add({name:"bounce",fn:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}}),b.add({name:"poly",fc:function(t){return function(i){return Math.pow(i,t)}}}),b.add({name:"elastic",fc:function(t,i){i=i||.45,t=t||1;var e=i/(2*Math.PI)*Math.asin(1/t);return function(s){return 1+t*Math.pow(2,-10*s)*Math.sin((s-e)*(2*Math.PI)/i)}}}),b.add({name:"back",fc:function(t){return t=typeof t<"u"?t:1.70158,function(i){return i*i*((t+1)*i-t)}}}),a.prototype.tween=function(t,i,e){if(typeof t!="number"?(e=t,i=0,t=0):typeof i!="number"&&(e=i,i=0),!this._tweens){this._tweens=[];var s=0;this.tick(function(r,h,_){if(this._tweens.length){var o=s!=_;if(s=h,o)return!0;var p=this._tweens[0],u=p.tick(this,r,h,_);if(u&&p===this._tweens[0]&&this._tweens.shift(),Array.isArray(u))for(var f=0;f<u.length;f++)try{u[f].call(this)}catch(c){console.log(c)}else typeof u=="object"&&this._tweens.unshift(u);return!0}},!0)}this.touch(),e||(this._tweens.length=0);var n=new D(this,t,i);return this._tweens.push(n),n};class D{constructor(i,e,s){this._end={},this._duration=e||400,this._delay=s||0,this._owner=i,this._time=0}tick(i,e,s,n){if(this._time+=e,!(this._time<this._delay)){var r=this._time-this._delay;if(!this._start){this._start={};for(var h in this._end)this._start[h]=this._owner.pin(h)}var _,o;r<this._duration?(_=r/this._duration,o=!1):(_=1,o=!0),typeof this._easing=="function"&&(_=this._easing(_));var p=1-_;for(var h in this._end)this._owner.pin(h,this._start[h]*p+this._end[h]*_);if(o){var u=[this._hide,this._remove,this._done];return u=u.filter(function(f){return typeof f=="function"}),this._next||u}}}tween(i,e){return this._next=new D(this._owner,i,e)}duration(i){return this._duration=i,this}delay(i){return this._delay=i,this}ease(i){return this._easing=b.get(i),this}done(i){return this._done=i,this}hide(){return this._hide=function(){this.hide()},this}remove(){return this._remove=function(){this.remove()},this}pin(i,e){if(typeof i=="object")for(var s in i)dt(this._owner,this._end,s,i[s]);else typeof e<"u"&&dt(this._owner,this._end,i,e);return this}then(i){return this.done(i),this}clear(i){return this}}function dt(t,i,e,s){typeof t.pin(e)=="number"?i[e]=s:typeof t.pin(e+"X")=="number"&&typeof t.pin(e+"Y")=="number"&&(i[e+"X"]=s,i[e+"Y"]=s)}Y._add_shortcuts(D.prototype);var I=[];const vt=function(){for(var t=I.length-1;t>=0;t--)I[t].pause()},gt=function(){for(var t=I.length-1;t>=0;t--)I[t].resume()},mt=function(t={}){var i=new B;return i.mount(t),i.mouse=new F().mount(i,i.dom),i};B._super=a,B.prototype=Object.create(B._super.prototype);function B(){B._super.call(this),this.label("Root")}B.prototype.mount=function(t={}){var i,e=null,s=!1,n=0,r=0,h=1,_=!1,o=!0;if(typeof t.canvas=="string"&&(i=document.getElementById(t.canvas)),i||(i=document.getElementById("cutjs")||document.getElementById("stage")),!i){s=!0,console.log("Creating Canvas..."),i=document.createElement("canvas"),i.style.position="absolute",i.style.top="0",i.style.left="0";var p=document.body;p.insertBefore(i,p.firstChild)}this.dom=i,e=i.getContext("2d");var u=window.devicePixelRatio||1,f=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;h=u/f;var c=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(X){return window.setTimeout(X,1e3/60)},g=0,m=X=>{if(!(!_||o)){var P=g||X,ht=X-P;g=X;var Ot=this._tick(ht,X,P);this._mo_touch!=this._ts_touch?(this._mo_touch=this._ts_touch,y(),c(m)):Ot?c(m):o=!0,w.fps=ht?1e3/ht:0}},y=()=>{n>0&&r>0&&(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,n,r),this.render(e))},M=-1,T=-1,x=()=>{if(_){var X,P;s?(X=window.innerWidth>0?window.innerWidth:screen.width,P=window.innerHeight>0?window.innerHeight:screen.height):(X=i.clientWidth,P=i.clientHeight),(M!==X||T!==P)&&(M=X,T=P,$()),c(x)}},$=()=>{s?(n=window.innerWidth>0?window.innerWidth:screen.width,r=window.innerHeight>0?window.innerHeight:screen.height,i.style.width=n+"px",i.style.height=r+"px"):(n=i.clientWidth,r=i.clientHeight),n*=h,r*=h,!(i.width===n&&i.height===r)&&(i.width=n,i.height=r,console.log("Resize: "+n+" x "+r+" / "+h),this.viewport(n,r,h),y())};this.resume=function(){return o&&(this.publish("resume"),o=!1,c(m)),this},this.pause=function(){return o||this.publish("pause"),o=!0,this},this.touch_root=this.touch,this.touch=function(){return this.resume(),this.touch_root()},this.unmount=function(){var P;_=!1;var X=I.indexOf(this);return X>=0&&I.splice(X,1),(P=this.mouse)==null||P.unmount(),this},_=!0,I.push(this),x(),c(m)},B.prototype.background=function(t){return this.dom.style.backgroundColor=t,this},B.prototype.viewport=function(t,i,e){if(typeof t>"u")return Object.assign({},this._viewport);this._viewport={width:t,height:i,ratio:e||1},this.viewbox();var s=Object.assign({},this._viewport);return this.visit({start:function(n){if(!n._flag("viewport"))return!0;n.publish("viewport",[s])}}),this},B.prototype.viewbox=function(t,i,e){typeof t=="number"&&typeof i=="number"&&(this._viewbox={width:t,height:i,mode:/^(in|out|in-pad|out-crop)$/.test(e)?e:"in-pad"});var s=this._viewbox,n=this._viewport;return n&&s?(this.pin({width:s.width,height:s.height}),this.scaleTo(n.width,n.height,s.mode)):n&&this.pin({width:n.width,height:n.height}),this};const rt=function(t){var i=new S;return t&&i.image(t),i};S._super=a,S.prototype=Object.create(S._super.prototype);function S(){S._super.call(this),this.label("Sprite"),this._textures=[],this._image=null}S.prototype.image=function(t){return this._image=V(t).one(),this.pin("width",this._image?this._image.width:0),this.pin("height",this._image?this._image.height:0),this._textures[0]=this._image.pipe(),this._textures.length=1,this},S.prototype.tile=function(t){return this._repeat(!1,t),this},S.prototype.stretch=function(t){return this._repeat(!0,t),this},S.prototype._repeat=function(t,i){var e=this;this.untick(this._repeatTicker),this.tick(this._repeatTicker=function(){if(this._mo_stretch!=this._pin._ts_transform){this._mo_stretch=this._pin._ts_transform;var n=this.pin("width"),r=this.pin("height");this._textures.length=Lt(this._image,n,r,t,i,s)}});function s(n,r,h,_,o,p,u,f,c){var g=e._textures.length>n?e._textures[n]:e._textures[n]=e._image.pipe();g.src(r,h,_,o),g.dest(p,u,f,c)}};function Lt(t,i,e,s,n,r){var h=t.width,_=t.height,o=t.left,p=t.right,u=t.top,f=t.bottom;o=typeof o=="number"&&o===o?o:0,p=typeof p=="number"&&p===p?p:0,u=typeof u=="number"&&u===u?u:0,f=typeof f=="number"&&f===f?f:0,h=h-o-p,_=_-u-f,n||(i=Math.max(i-o-p,0),e=Math.max(e-u-f,0));var c=0;if(u>0&&o>0&&r(c++,0,0,o,u,0,0,o,u),f>0&&o>0&&r(c++,0,_+u,o,f,0,e+u,o,f),u>0&&p>0&&r(c++,h+o,0,p,u,i+o,0,p,u),f>0&&p>0&&r(c++,h+o,_+u,p,f,i+o,e+u,p,f),s)u>0&&r(c++,o,0,h,u,o,0,i,u),f>0&&r(c++,o,_+u,h,f,o,e+u,i,f),o>0&&r(c++,0,u,o,_,0,u,o,e),p>0&&r(c++,h+o,u,p,_,i+o,u,p,e),r(c++,o,u,h,_,o,u,i,e);else for(var g=o,m=i,y;m>0;){y=Math.min(h,m),m-=h;for(var M=u,T=e,x;T>0;)x=Math.min(_,T),T-=_,r(c++,o,u,y,x,g,M,y,x),m<=0&&(o&&r(c++,0,u,o,x,0,M,o,x),p&&r(c++,h+o,u,p,x,g+y,M,p,x)),M+=x;u&&r(c++,o,0,y,u,g,0,y,u),f&&r(c++,o,_+u,y,f,g,M,y,f),g+=y}return c}const yt=rt,wt=S,bt=function(t,i){var e=new k;return e.frames(t).gotoFrame(0),i&&e.fps(i),e};k._super=a,k.prototype=Object.create(k._super.prototype);const xt=15;function k(){k._super.call(this),this.label("Anim"),this._textures=[],this._fps=xt,this._ft=1e3/this._fps,this._time=-1,this._repeat=0,this._index=0,this._frames=[];var t=0;this.tick(function(i,e,s){if(!(this._time<0||this._frames.length<=1)){var n=t!=s;if(t=e,n||(this._time+=i,this._time<this._ft))return!0;var r=this._time/this._ft|0;return this._time-=r*this._ft,this.moveFrame(r),this._repeat>0&&(this._repeat-=r)<=0?(this.stop(),this._callback&&this._callback(),!1):!0}},!1)}k.prototype.fps=function(t){return typeof t>"u"?this._fps:(this._fps=t>0?t:xt,this._ft=1e3/this._fps,this)},k.prototype.setFrames=function(t,i,e){return this.frames(t,i,e)},k.prototype.frames=function(t){return this._index=0,this._frames=V(t).array(),this.touch(),this},k.prototype.length=function(){return this._frames?this._frames.length:0},k.prototype.gotoFrame=function(t,i){return this._index=R.modulo(t,this._frames.length)|0,i=i||!this._textures[0],this._textures[0]=this._frames[this._index],i&&(this.pin("width",this._textures[0].width),this.pin("height",this._textures[0].height)),this.touch(),this},k.prototype.moveFrame=function(t){return this.gotoFrame(this._index+t)},k.prototype.repeat=function(t,i){return this._repeat=t*this._frames.length-1,this._callback=i,this.play(),this},k.prototype.play=function(t){return typeof t<"u"?(this.gotoFrame(t),this._time=0):this._time<0&&(this._time=0),this.touch(),this},k.prototype.stop=function(t){return this._time=-1,typeof t<"u"&&this.gotoFrame(t),this};const kt=function(t){return new H().frames(t)};H._super=a,H.prototype=Object.create(H._super.prototype);function H(){H._super.call(this),this.label("String"),this._textures=[]}H.prototype.setFont=function(t,i,e){return this.frames(t,i,e)},H.prototype.frames=function(t){return this._textures=[],typeof t=="string"?(t=V(t),this._item=function(i){return t.one(i)}):typeof t=="object"?this._item=function(i){return t[i]}:typeof t=="function"&&(this._item=t),this},H.prototype.setValue=function(t,i,e){return this.value(t,i,e)},H.prototype.value=function(t){if(typeof t>"u")return this._value;if(this._value===t)return this;this._value=t,t===null?t="":typeof t!="string"&&!Array.isArray(t)&&(t=t.toString()),this._spacing=this._spacing||0;for(var i=0,e=0,s=0;s<t.length;s++){var n=this._textures[s]=this._item(t[s]);i+=s>0?this._spacing:0,n.dest(i,0),i=i+n.width,e=Math.max(e,n.height)}return this.pin("width",i),this.pin("height",e),this._textures.length=t.length,this};const Xt=function(t){return N().row(t).label("Row")};a.prototype.row=function(t){return this.align("row",t),this};const Yt=function(t){return N().column(t).label("Row")};a.prototype.column=function(t){return this.align("column",t),this},a.prototype.align=function(t,i){return this._padding=this._padding||0,this._spacing=this._spacing||0,this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){if(this._mo_seq!=this._ts_touch){this._mo_seq=this._ts_touch;var e=this._mo_seqAlign!=this._ts_children;this._mo_seqAlign=this._ts_children;for(var s=0,n=0,r,h=this.first(!0),_=!0;r=h;){h=r.next(!0),r.matrix(!0);var o=r.pin("boxWidth"),p=r.pin("boxHeight");t=="column"?(!_&&(n+=this._spacing),r.pin("offsetY")!=n&&r.pin("offsetY",n),s=Math.max(s,o),n=n+p,e&&r.pin("alignX",i)):t=="row"&&(!_&&(s+=this._spacing),r.pin("offsetX")!=s&&r.pin("offsetX",s),s=s+o,n=Math.max(n,p),e&&r.pin("alignY",i)),_=!1}s+=2*this._padding,n+=2*this._padding,this.pin("width")!=s&&this.pin("width",s),this.pin("height")!=n&&this.pin("height",n)}}),this};const At=function(){return N().box().label("Box")};a.prototype.box=function(){return this._padding=this._padding||0,this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){if(this._mo_box!=this._ts_touch){this._mo_box=this._ts_touch;for(var t=0,i=0,e,s=this.first(!0);e=s;){s=e.next(!0),e.matrix(!0);var n=e.pin("boxWidth"),r=e.pin("boxHeight");t=Math.max(t,n),i=Math.max(i,r)}t+=2*this._padding,i+=2*this._padding,this.pin("width")!=t&&this.pin("width",t),this.pin("height")!=i&&this.pin("height",i)}}),this};const Mt=function(){return N().layer().label("Layer")};a.prototype.layer=function(){return this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){var t=this.parent();if(t){var i=t.pin("width");this.pin("width")!=i&&this.pin("width",i);var e=t.pin("height");this.pin("height")!=e&&this.pin("height",e)}},!0),this},a.prototype.padding=function(t){return this._padding=t,this},a.prototype.spacing=function(t){return this._spacing=t,this};const Rt=Object.freeze(Object.defineProperty({__proto__:null,Anim:k,Atlas:st,Image:wt,Matrix:A,Mouse:F,Node:a,Pin:Y,Root:B,Sprite:S,Str:H,Texture:j,Tween:D,anim:bt,atlas:ut,box:At,canvas:_t,column:Yt,create:N,image:yt,layer:Mt,math:R,mount:mt,pause:vt,resume:gt,row:Xt,sprite:rt,string:kt,texture:V},Symbol.toStringTag,{value:"Module"}));l.Anim=k,l.Atlas=st,l.Image=wt,l.Matrix=A,l.Mouse=F,l.Node=a,l.Pin=Y,l.Root=B,l.Sprite=S,l.Str=H,l.Texture=j,l.Tween=D,l.anim=bt,l.atlas=ut,l.box=At,l.canvas=_t,l.column=Yt,l.create=N,l.default=Rt,l.image=yt,l.layer=Mt,l.math=R,l.mount=mt,l.pause=vt,l.resume=gt,l.row=Xt,l.sprite=rt,l.string=kt,l.texture=V,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
